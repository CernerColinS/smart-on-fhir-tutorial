<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel='stylesheet' type='text/css' href='./src/css/example-smart-app.css'>
    <!--
      Temporarily disable cerner-smart-embeddable-lib
      <link rel='stylesheet' type='text/css' href='./lib/css/cerner-smart-embeddable-lib-1.0.0.min.css'>
    -->
    <title>Example-SMART-App-iFrame-Wrapper</title>
  </head>
  <body>
    <div id="constant_reminder">
      <h1>iFrame Wrapper for SMART on FHIR example</h1>
    </div>
    <div id="button_list"></div>
    <div id="iframe_wrapper"></div>

    <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>

    <script>
      //REACT JS GOES HERE
      let populateIFrame = function(launchURL) {
        const iframeContainer = document.querySelector('#iframe_wrapper');
        /*let url = new URL(window.location + "");
        let iss = url.searchParams.get("iss");
        let launch = url.searchParams.get("launch");*/
        let iframe = React.createElement('iframe',
          {src: launchURL,
           height: "640px",
           width: "960px"});
        ReactDOM.render(iframe, iframeContainer);
      }
      /*populateIFrame(`https://CernerColinS.github.io/smart-on-fhir-tutorial/example-smart-app/launch.html${window.location.search}`);*/
      const buttonList = document.querySelector('#button_list');
      let ehrLaunchButton = React.createElement('button',
          {onClick: function() {
                  populateIFrame(`https://CernerColinS.github.io/smart-on-fhir-tutorial/example-smart-app/launch.html${window.location.search}`);},
           type: 'button',
           key: 1}, 'EHR Launch');
      let patientISS = "https://fhir-myrecord.sandboxcerner.com/dstu2/0b8a0111-e8e6-4c26-a91c-5069cbc6b1ca";
      let patientLaunchButton = React.createElement('button', 
          {onClick: function() {
		  populateIFrame(`https://CernerColinS.github.io/smart-on-fhir-tutorial/example-smart-app/launch-patient.html?iss=${patientISS}`);},
           type: 'button',
           key: 2}, 'Patient Launch');
      ReactDOM.render([ehrLaunchButton, patientLaunchButton], buttonList);
    </script>
  </body>
</html>
